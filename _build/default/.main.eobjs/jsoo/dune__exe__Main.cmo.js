// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cmo, use-js-string=true, version=5.9.1

//# unitInfo: Provides: Dune__exe__Main
//# unitInfo: Requires: Js_of_ocaml__Dom, Js_of_ocaml__Dom_html, Js_of_ocaml__Js, Js_of_ocaml_lwt__Lwt_js, Js_of_ocaml_lwt__Lwt_js_events, Lwt, Stdlib, Stdlib__List, Stdlib__Random
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_lime$0 = "lime",
    cst_px$5 = "px",
    caml_jsstring_of_string = runtime.caml_jsstring_of_string,
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace,
    caml_wrap_exception = runtime.caml_wrap_exception;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) === 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) === 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) === 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call5(f, a0, a1, a2, a3, a4){
    return (f.l >= 0 ? f.l : f.l = f.length) === 5
            ? f(a0, a1, a2, a3, a4)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Stdlib = global_data.Stdlib,
    Js_of_ocaml_lwt_Lwt_js = global_data.Js_of_ocaml_lwt__Lwt_js,
    Lwt = global_data.Lwt,
    Stdlib_List = global_data.Stdlib__List,
    Stdlib_Random = global_data.Stdlib__Random,
    Js_of_ocaml_lwt_Lwt_js_events = global_data.Js_of_ocaml_lwt__Lwt_js_events,
    Js_of_ocaml_Dom_html = global_data.Js_of_ocaml__Dom_html,
    Js_of_ocaml_Dom = global_data.Js_of_ocaml__Dom,
    document = Js_of_ocaml_Dom_html[2],
    world = caml_call1(Js_of_ocaml_Dom_html[4], "world"),
    creets = [0, 0],
    cst_px = cst_px$5,
    cst_px$0 = cst_px$5,
    cst_px$1 = cst_px$5,
    cst_px$2 = cst_px$5,
    cst_px$3 = cst_px$5,
    cst_px$4 = cst_px$5,
    cst_lime = cst_lime$0;
   function move_creet(t13, state){
    if(1 - state[6]){
     var
      w = world.clientWidth,
      h = world.clientHeight,
      nx = state[1] + state[3] | 0,
      ny = state[2] + state[4] | 0;
     a:
     {
      if(0 <= nx && (w - 20 | 0) >= nx){
       var nx$0 = nx, dx = state[3];
       break a;
      }
      var
       _m_ = caml_call2(Stdlib[16], w - 20 | 0, nx),
       _n_ = caml_call2(Stdlib[17], 0, _m_),
       nx$0 = _n_,
       dx = - state[3] | 0;
     }
     a:
     {
      if(0 <= ny && (h - 20 | 0) >= ny){
       var ny$0 = ny, dy = state[4];
       break a;
      }
      var
       _o_ = caml_call2(Stdlib[16], h - 20 | 0, ny),
       _p_ = caml_call2(Stdlib[17], 0, _o_),
       ny$0 = _p_,
       dy = - state[4] | 0;
     }
     state[3] = dx;
     state[4] = dy;
     state[1] = nx$0;
     state[2] = ny$0;
     var _q_ = state[2] < 50 ? 1 : 0, _r_ = _q_ ? 1 - state[5] : _q_;
     if(_r_){state[5] = 1; var t15 = t13.style; t15.backgroundColor = "red";}
     var
      _s_ = caml_call1(Stdlib[33], state[1]),
      t17 = caml_jsstring_of_string(caml_call2(Stdlib[28], _s_, cst_px$1)),
      t18 = t13.style;
     t18.left = t17;
     var
      _t_ = caml_call1(Stdlib[33], state[2]),
      t20 = caml_jsstring_of_string(caml_call2(Stdlib[28], _t_, cst_px$2)),
      t21 = t13.style;
     t21.top = t20;
    }
    var
     delay = state[5] ? 0.05 : 0.03,
     ppx_lwt_0 = caml_call1(Js_of_ocaml_lwt_Lwt_js[1], delay);
    return caml_call3
            (Lwt[81],
             function(exn){
              try{throw caml_maybe_attach_backtrace(exn, 0);}
              catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
             },
             ppx_lwt_0,
             function(param){return move_creet(t13, state);});
   }
   function add_creet(color, x, y){
    var t24 = caml_call1(Js_of_ocaml_Dom_html[51], document);
    t24.className = "creet";
    var t3 = caml_jsstring_of_string(color), t4 = t24.style;
    t4.backgroundColor = t3;
    var
     _a_ = caml_call1(Stdlib[33], x),
     t6 = caml_jsstring_of_string(caml_call2(Stdlib[28], _a_, cst_px)),
     t7 = t24.style;
    t7.left = t6;
    var
     _b_ = caml_call1(Stdlib[33], y),
     t9 = caml_jsstring_of_string(caml_call2(Stdlib[28], _b_, cst_px$0)),
     t10 = t24.style;
    t10.top = t9;
    caml_call2(Js_of_ocaml_Dom[5], world, t24);
    var
     v = caml_call1(Stdlib_Random[5], 5) - 2 | 0,
     _c_ = 0,
     _d_ = 0,
     _e_ = 0 === v ? 1 : v,
     v$0 = caml_call1(Stdlib_Random[5], 5) - 2 | 0,
     _f_ = 0 === v$0 ? 1 : v$0,
     state = [0, x, y, _f_, _e_, _d_, _c_];
    creets[1] = [0, [0, t24, state], creets[1]];
    caml_call1(Lwt[11], function(param){return move_creet(t24, state);});
    return caml_call1
            (Lwt[11],
             function(param){
              var
               offset_x = [0, 0],
               offset_y = [0, 0],
               world_rect = [0, world.getBoundingClientRect()];
              caml_call1
               (Lwt[11],
                function(param){
                 return caml_call5
                         (Js_of_ocaml_lwt_Lwt_js_events[82],
                          0,
                          0,
                          0,
                          t24,
                          function(t25, param){
                           state[6] = 1;
                           world_rect[1] = world.getBoundingClientRect();
                           var rect = t24.getBoundingClientRect();
                           offset_x[1] = t25.clientX - rect.left | 0;
                           offset_y[1] = t25.clientY - rect.top | 0;
                           return Lwt[36];
                          });
                });
              caml_call1
               (Lwt[11],
                function(param){
                 return caml_call5
                         (Js_of_ocaml_lwt_Lwt_js_events[83],
                          0,
                          0,
                          0,
                          document,
                          function(param, _i_){
                           var h = world.clientHeight, _j_ = state[6];
                           if(_j_)
                            var
                             _k_ = state[5],
                             _l_ = _k_ ? (h - 70 | 0) < state[2] ? 1 : 0 : _k_;
                           else
                            var _l_ = _j_;
                           if(_l_){
                            state[5] = 0;
                            var t32 = t24.style;
                            t32.backgroundColor = cst_lime$0;
                           }
                           state[6] = 0;
                           return Lwt[36];
                          });
                });
              caml_call1
               (Lwt[11],
                function(param){
                 return caml_call5
                         (Js_of_ocaml_lwt_Lwt_js_events[85],
                          0,
                          0,
                          0,
                          document,
                          function(t33, param){
                           if(state[6]){
                            var
                             t34 = world_rect[1],
                             nx = (t33.clientX - t34.left | 0) - offset_x[1] | 0,
                             ny = (t33.clientY - t34.top | 0) - offset_y[1] | 0;
                            state[1] = nx;
                            state[2] = ny;
                            var
                             _g_ = caml_call1(Stdlib[33], nx),
                             t38 =
                               caml_jsstring_of_string
                                (caml_call2(Stdlib[28], _g_, cst_px$3)),
                             t39 = t24.style;
                            t39.left = t38;
                            var
                             _h_ = caml_call1(Stdlib[33], ny),
                             t41 =
                               caml_jsstring_of_string
                                (caml_call2(Stdlib[28], _h_, cst_px$4)),
                             t42 = t24.style;
                            t42.top = t41;
                           }
                           return Lwt[36];
                          });
                });
              return Lwt[36];
             });
   }
   function reproduction_loop(param){
    var
     healthy_exists =
       caml_call2
        (Stdlib_List[33],
         function(param){var st = param[2]; return 1 - st[5];},
         creets[1]);
    if(healthy_exists && caml_call1(Stdlib_Random[10], 1.) < 0.3){
     var
      x = caml_call1(Stdlib_Random[5], world.clientWidth - 30 | 0),
      y = caml_call1(Stdlib_Random[5], world.clientHeight - 30 | 0);
     add_creet(cst_lime, x, y);
    }
    var ppx_lwt_0 = caml_call1(Js_of_ocaml_lwt_Lwt_js[1], 2.);
    return caml_call3
            (Lwt[81],
             function(exn){
              try{throw caml_maybe_attach_backtrace(exn, 0);}
              catch(exn){var exn$0 = caml_wrap_exception(exn); return exn$0;}
             },
             ppx_lwt_0,
             function(param){return reproduction_loop(0);});
   }
   caml_call1(Stdlib_Random[3], 0);
   add_creet(cst_lime$0, 200, 200);
   caml_call1(Lwt[11], reproduction_loop);
   var Dune_exe_Main = [0];
   runtime.caml_register_global(60, Dune_exe_Main, "Dune__exe__Main");
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLm1haW4uZW9ianMvanNvby9kdW5lX19leGVfX01haW4uY21vLmpzIiwic2VjdGlvbnMiOlt7Im9mZnNldCI6eyJsaW5lIjo5LCJjb2x1bW4iOjB9LCJtYXAiOnsidmVyc2lvbiI6MywiZmlsZSI6Ii5tYWluLmVvYmpzL2pzb28vZHVuZV9fZXhlX19NYWluLmNtby5qcyIsIm5hbWVzIjpbInJ1bnRpbWUiLCJjc3RfbGltZSIsImNzdF9weCIsImNhbWxfanNzdHJpbmdfb2Zfc3RyaW5nIiwiY2FtbF9tYXliZV9hdHRhY2hfYmFja3RyYWNlIiwiY2FtbF93cmFwX2V4Y2VwdGlvbiIsImNhbWxfY2FsbDEiLCJmIiwiYTAiLCJjYW1sX2NhbGwyIiwiYTEiLCJjYW1sX2NhbGwzIiwiYTIiLCJjYW1sX2NhbGw1IiwiYTMiLCJhNCIsImdsb2JhbF9kYXRhIiwiU3RkbGliIiwiSnNfb2Zfb2NhbWxfbHd0X0x3dF9qcyIsIkx3dCIsIlN0ZGxpYl9MaXN0IiwiU3RkbGliX1JhbmRvbSIsIkpzX29mX29jYW1sX2x3dF9Md3RfanNfZXZlbnRzIiwiSnNfb2Zfb2NhbWxfRG9tX2h0bWwiLCJKc19vZl9vY2FtbF9Eb20iLCJkb2N1bWVudCIsIndvcmxkIiwiY3JlZXRzIiwibW92ZV9jcmVldCIsInQxMyIsInN0YXRlIiwidyIsImgiLCJueCIsIm55IiwiZHgiLCJkeSIsInQxNSIsInQxNyIsInQxOCIsInQyMCIsInQyMSIsImRlbGF5IiwicHB4X2x3dF8wIiwiZXhuIiwicGFyYW0iLCJhZGRfY3JlZXQiLCJjb2xvciIsIngiLCJ5IiwidDI0IiwidDMiLCJ0NCIsInQ2IiwidDciLCJ0OSIsInQxMCIsInYiLCJvZmZzZXRfeCIsIm9mZnNldF95Iiwid29ybGRfcmVjdCIsInQyNSIsInJlY3QiLCJ0MzIiLCJ0MzMiLCJ0MzQiLCJ0MzgiLCJ0MzkiLCJ0NDEiLCJ0NDIiLCJyZXByb2R1Y3Rpb25fbG9vcCIsImhlYWx0aHlfZXhpc3RzIiwic3QiLCJEdW5lX2V4ZV9NYWluIl0sInNvdXJj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O0FBQUFBLE9BR3ZCO0FBQUE7QUFBQSxrQkFBQTFCLFdBQUEyQixLQUFZLFVBQWdCLGlCQUFnQjtBQUFBO0FBQUEsSUFDakUscUJBQ0s7QUFBQTtBQUFBLE1BQUF4QixJQUNPO0FBQUEsTUFBQUMsSUFDQTtBQUFBLEtBQ1I7QUFBQTtBQUFBLFFBQUFOLFlBR1M7QUFBQSxJQUFiO0FBQUE7QUFBQSxzQkFBQUM7QUFBQUEsY0FBQTtBQUFBLG9CQUFBQSxTQUFBQSxRRC9IRiwwQkMrSEU7QUFBQSxhQUNvQjtBQUFBO0FBQUEsc0JBQUFDLE9BQXBCLDJCQUFvQjtBQUFBO0FBQUEsR0FHcEI7QUFBQSxHQUNBO0FBQUEsR0FDQTtBQUFBLE9BQUE0QixnQkFBMkI7QUFBQTtBQUFBO0FBQUEsRURySTdCIiwic291cmNlc0NvbnRlbnQiOlsiKCogZ2VuZXJhdGVkIGNvZGUgKikiLCJvcGVuIEpzX29mX29jYW1sXHJcbm9wZW4gSnNfb2Zfb2NhbWxfbHd0XHJcblxyXG5sZXQgZG9jdW1lbnQgPSBEb21faHRtbC5kb2N1bWVudFxyXG5sZXQgd29ybGQgPSBEb21faHRtbC5nZXRFbGVtZW50QnlJZF9leG4gXCJ3b3JsZFwiXHJcblxyXG50eXBlIGNyZWV0X3N0YXRlID0ge1xyXG4gIG11dGFibGUgeDogaW50O1xyXG4gIG11dGFibGUgeTogaW50O1xyXG4gIG11dGFibGUgZHg6IGludDtcclxuICBtdXRhYmxlIGR5OiBpbnQ7XHJcbiAgbXV0YWJsZSBpbmZlY3RlZDogYm9vbDtcclxuICBtdXRhYmxlIGlzX2JlaW5nX2RyYWdnZWQ6IGJvb2w7XHJcbn1cclxuXHJcbmxldCBjcmVldHMgOiAoRG9tX2h0bWwuZGl2RWxlbWVudCBKcy50ICogY3JlZXRfc3RhdGUpIGxpc3QgcmVmID0gcmVmIFtdXHJcblxyXG5sZXQgY3JlYXRlX2NyZWV0IGNvbG9yIHggeSA9XHJcbiAgbGV0IGQgPSBEb21faHRtbC5jcmVhdGVEaXYgZG9jdW1lbnQgaW5cclxuICBkIyMuY2xhc3NOYW1lIDo9IEpzLnN0cmluZyBcImNyZWV0XCI7XHJcbiAgZCMjLnN0eWxlIyMuYmFja2dyb3VuZENvbG9yIDo9IEpzLnN0cmluZyBjb2xvcjtcclxuICBkIyMuc3R5bGUjIy5sZWZ0IDo9IEpzLnN0cmluZyAoc3RyaW5nX29mX2ludCB4IF4gXCJweFwiKTtcclxuICBkIyMuc3R5bGUjIy50b3AgOj0gSnMuc3RyaW5nIChzdHJpbmdfb2ZfaW50IHkgXiBcInB4XCIpO1xyXG4gIERvbS5hcHBlbmRDaGlsZCB3b3JsZCBkO1xyXG4gIGRcclxuXHJcbmxldCByZWMgbW92ZV9jcmVldCBkIHN0YXRlID1cclxuICBpZiBub3Qgc3RhdGUuaXNfYmVpbmdfZHJhZ2dlZCB0aGVuIChcclxuICAgIGxldCB3ID0gd29ybGQjIy5jbGllbnRXaWR0aCBhbmQgaCA9IHdvcmxkIyMuY2xpZW50SGVpZ2h0IGluXHJcbiAgICBsZXQgbnggPSBzdGF0ZS54ICsgc3RhdGUuZHggYW5kIG55ID0gc3RhdGUueSArIHN0YXRlLmR5IGluXHJcblxyXG4gICAgbGV0IGR4LCBueCA9XHJcbiAgICAgIGlmIG54IDwgMCB8fCBueCA+IHcgLSAyMCB0aGVuICgtc3RhdGUuZHgsIG1heCAwIChtaW4gKHcgLSAyMCkgbngpKVxyXG4gICAgICBlbHNlIChzdGF0ZS5keCwgbngpXHJcbiAgICBpblxyXG4gICAgbGV0IGR5LCBueSA9XHJcbiAgICAgIGlmIG55IDwgMCB8fCBueSA+IGggLSAyMCB0aGVuICgtc3RhdGUuZHksIG1heCAwIChtaW4gKGggLSAyMCkgbnkpKVxyXG4gICAgICBlbHNlIChzdGF0ZS5keSwgbnkpXHJcbiAgICBpblxyXG5cclxuICAgIHN0YXRlLmR4IDwtIGR4O1xyXG4gICAgc3RhdGUuZHkgPC0gZHk7XHJcbiAgICBzdGF0ZS54IDwtIG54O1xyXG4gICAgc3RhdGUueSA8LSBueTtcclxuXHJcbiAgICAoKiDQmNC90YTQtdC60YbQuNGPINCyINCy0LXRgNGF0L3QtdC5INC30L7QvdC1ICopXHJcbiAgICBpZiBzdGF0ZS55IDwgNTAgJiYgbm90IHN0YXRlLmluZmVjdGVkIHRoZW4gKFxyXG4gICAgICBzdGF0ZS5pbmZlY3RlZCA8LSB0cnVlO1xyXG4gICAgICBkIyMuc3R5bGUjIy5iYWNrZ3JvdW5kQ29sb3IgOj0gSnMuc3RyaW5nIFwicmVkXCJcclxuICAgICk7XHJcblxyXG4gICAgKCog0JDQstGC0L7QvNCw0YLQuNGH0LXRgdC60L7QtSDQutCw0YHQsNC90LjQtSDQsdC+0LvRjNC90LjRhtGLINC90LUg0LvQtdGH0LjRgiAqKVxyXG4gICAgKCogKNC90LjRh9C10LPQviDQvdC1INC00LXQu9Cw0LXQvCDQt9C00LXRgdGMKSAqKVxyXG5cclxuICAgIGQjIy5zdHlsZSMjLmxlZnQgOj0gSnMuc3RyaW5nIChzdHJpbmdfb2ZfaW50IHN0YXRlLnggXiBcInB4XCIpO1xyXG4gICAgZCMjLnN0eWxlIyMudG9wIDo9IEpzLnN0cmluZyAoc3RyaW5nX29mX2ludCBzdGF0ZS55IF4gXCJweFwiKTtcclxuICApO1xyXG5cclxuICBsZXQgZGVsYXkgPSBpZiBzdGF0ZS5pbmZlY3RlZCB0aGVuIDAuMDUgZWxzZSAwLjAzIGluXHJcbiAgbGV0JWx3dCAoKSA9IEx3dF9qcy5zbGVlcCBkZWxheSBpblxyXG4gIG1vdmVfY3JlZXQgZCBzdGF0ZVxyXG5cclxubGV0IG1ha2VfZHJhZ2dhYmxlIGQgc3RhdGUgPVxyXG4gIGxldCBvcGVuIEx3dF9qc19ldmVudHMgaW5cclxuICBsZXQgb2Zmc2V0X3ggPSByZWYgMCBhbmQgb2Zmc2V0X3kgPSByZWYgMCBpblxyXG4gIGxldCB3b3JsZF9yZWN0ID0gcmVmICh3b3JsZCMjZ2V0Qm91bmRpbmdDbGllbnRSZWN0KSBpblxyXG5cclxuICBMd3QuYXN5bmMgKGZ1biAoKSAtPlxyXG4gICAgbW91c2Vkb3ducyBkIChmdW4gZXYgXyAtPlxyXG4gICAgICBzdGF0ZS5pc19iZWluZ19kcmFnZ2VkIDwtIHRydWU7XHJcbiAgICAgIHdvcmxkX3JlY3QgOj0gd29ybGQjI2dldEJvdW5kaW5nQ2xpZW50UmVjdDtcclxuICAgICAgbGV0IHJlY3QgPSBkIyNnZXRCb3VuZGluZ0NsaWVudFJlY3QgaW5cclxuICAgICAgb2Zmc2V0X3ggOj0gaW50X29mX2Zsb2F0IChmbG9hdF9vZl9pbnQgZXYjIy5jbGllbnRYIC0uIHJlY3QjIy5sZWZ0KTtcclxuICAgICAgb2Zmc2V0X3kgOj0gaW50X29mX2Zsb2F0IChmbG9hdF9vZl9pbnQgZXYjIy5jbGllbnRZIC0uIHJlY3QjIy50b3ApO1xyXG4gICAgICBMd3QucmV0dXJuX3VuaXQpXHJcbiAgKTtcclxuXHJcbiAgTHd0LmFzeW5jIChmdW4gKCkgLT5cclxuICAgIG1vdXNldXBzIGRvY3VtZW50IChmdW4gXyBfIC0+XHJcbiAgICAgICgqINCf0YDQuCDQvtGC0L/Rg9GB0LrQsNC90LjQuCDQvNGL0YjQuCDQv9GA0L7QstC10YDRj9C10LwsINC90LDRhdC+0LTQuNGC0YHRjyDQu9C4IENyZWV0INCyINC30L7QvdC1INCx0L7Qu9GM0L3QuNGG0YsgKilcclxuICAgICAgbGV0IGggPSB3b3JsZCMjLmNsaWVudEhlaWdodCBpblxyXG4gICAgICBpZiBzdGF0ZS5pc19iZWluZ19kcmFnZ2VkICYmIHN0YXRlLmluZmVjdGVkICYmIHN0YXRlLnkgPiBoIC0gNzAgdGhlbiAoXHJcbiAgICAgICAgc3RhdGUuaW5mZWN0ZWQgPC0gZmFsc2U7XHJcbiAgICAgICAgZCMjLnN0eWxlIyMuYmFja2dyb3VuZENvbG9yIDo9IEpzLnN0cmluZyBcImxpbWVcIlxyXG4gICAgICApO1xyXG4gICAgICBzdGF0ZS5pc19iZWluZ19kcmFnZ2VkIDwtIGZhbHNlO1xyXG4gICAgICBMd3QucmV0dXJuX3VuaXQpXHJcbiAgKTtcclxuXHJcbiAgTHd0LmFzeW5jIChmdW4gKCkgLT5cclxuICAgIG1vdXNlbW92ZXMgZG9jdW1lbnQgKGZ1biBldiBfIC0+XHJcbiAgICAgIGlmIHN0YXRlLmlzX2JlaW5nX2RyYWdnZWQgdGhlbiAoXHJcbiAgICAgICAgbGV0IHdyID0gIXdvcmxkX3JlY3QgaW5cclxuICAgICAgICBsZXQgbnggPSBpbnRfb2ZfZmxvYXQgKGZsb2F0X29mX2ludCBldiMjLmNsaWVudFggLS4gd3IjIy5sZWZ0KSAtICFvZmZzZXRfeCBpblxyXG4gICAgICAgIGxldCBueSA9IGludF9vZl9mbG9hdCAoZmxvYXRfb2ZfaW50IGV2IyMuY2xpZW50WSAtLiB3ciMjLnRvcCkgLSAhb2Zmc2V0X3kgaW5cclxuICAgICAgICBzdGF0ZS54IDwtIG54O1xyXG4gICAgICAgIHN0YXRlLnkgPC0gbnk7XHJcbiAgICAgICAgZCMjLnN0eWxlIyMubGVmdCA6PSBKcy5zdHJpbmcgKHN0cmluZ19vZl9pbnQgbnggXiBcInB4XCIpO1xyXG4gICAgICAgIGQjIy5zdHlsZSMjLnRvcCA6PSBKcy5zdHJpbmcgKHN0cmluZ19vZl9pbnQgbnkgXiBcInB4XCIpO1xyXG4gICAgICApO1xyXG4gICAgICBMd3QucmV0dXJuX3VuaXQpXHJcbiAgKTtcclxuXHJcbiAgTHd0LnJldHVybl91bml0XHJcblxyXG5sZXQgYWRkX2NyZWV0IGNvbG9yIHggeSA9XHJcbiAgbGV0IGQgPSBjcmVhdGVfY3JlZXQgY29sb3IgeCB5IGluXHJcbiAgbGV0IHN0YXRlID0ge1xyXG4gICAgeDsgeTtcclxuICAgIGR4ID0gKGxldCB2ID0gKFJhbmRvbS5pbnQgNSkgLSAyIGluIGlmIHYgPSAwIHRoZW4gMSBlbHNlIHYpO1xyXG4gICAgZHkgPSAobGV0IHYgPSAoUmFuZG9tLmludCA1KSAtIDIgaW4gaWYgdiA9IDAgdGhlbiAxIGVsc2Ugdik7XHJcbiAgICBpbmZlY3RlZCA9IGZhbHNlO1xyXG4gICAgaXNfYmVpbmdfZHJhZ2dlZCA9IGZhbHNlO1xyXG4gIH0gaW5cclxuICBjcmVldHMgOj0gKGQsIHN0YXRlKSA6OiAhY3JlZXRzO1xyXG4gIEx3dC5hc3luYyAoZnVuICgpIC0+IG1vdmVfY3JlZXQgZCBzdGF0ZSk7XHJcbiAgTHd0LmFzeW5jIChmdW4gKCkgLT4gbWFrZV9kcmFnZ2FibGUgZCBzdGF0ZSlcclxuXHJcbmxldCByZWMgcmVwcm9kdWN0aW9uX2xvb3AgKCkgPVxyXG4gIGxldCBoZWFsdGh5X2V4aXN0cyA9IExpc3QuZXhpc3RzIChmdW4gKF8sIHN0KSAtPiBub3Qgc3QuaW5mZWN0ZWQpICFjcmVldHMgaW5cclxuICBpZiBoZWFsdGh5X2V4aXN0cyB0aGVuIChcclxuICAgIGlmIFJhbmRvbS5mbG9hdCAxLjAgPCAwLjMgdGhlbiAoXHJcbiAgICAgIGxldCB4ID0gUmFuZG9tLmludCAod29ybGQjIy5jbGllbnRXaWR0aCAtIDMwKSBpblxyXG4gICAgICBsZXQgeSA9IFJhbmRvbS5pbnQgKHdvcmxkIyMuY2xpZW50SGVpZ2h0IC0gMzApIGluXHJcbiAgICAgIGFkZF9jcmVldCBcImxpbWVcIiB4IHk7XHJcbiAgICApXHJcbiAgKTtcclxuICBsZXQlbHd0ICgpID0gTHd0X2pzLnNsZWVwIDIuMCBpblxyXG4gIHJlcHJvZHVjdGlvbl9sb29wICgpXHJcblxyXG5sZXQgKCkgPVxyXG4gIFJhbmRvbS5zZWxmX2luaXQgKCk7XHJcbiAgYWRkX2NyZWV0IFwibGltZVwiIDIwMCAyMDA7XHJcbiAgTHd0LmFzeW5jIHJlcHJvZHVjdGlvbl9sb29wIl0sImlnbm9yZUxpc3QiOlswXX19XX0=
